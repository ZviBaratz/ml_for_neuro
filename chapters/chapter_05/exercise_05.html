
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercise V: Regularization &#8212; Machine Learning for Neuroscience</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Exercise VI: Revisiting Linear and Logistic Regression" href="../chapter_06/exercise_06.html" />
    <link rel="prev" title="Exercise IV: Logistic Regression" href="../chapter_04/exercise_04.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Machine Learning for Neuroscience</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../content.html">
   Contents
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_01/exercise_01.html">
     Exercise I: Exploratory Data Analysis (EDA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_02/exercise_02.html">
     Exercise II: k-Nearest Neighbors (k-NN)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_03/exercise_03.html">
     Exercise III: Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_04/exercise_04.html">
     Exercise IV: Logistic Regression
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Exercise V: Regularization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_06/exercise_06.html">
     Exercise VI: Revisiting Linear and Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_07/exercise_07.html">
     Exercise VII: Decision Trees and Random Forests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_08/exercise_08.html">
     Exercise VIII: K-Means Clustering and PCA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../chapter_09/exercise_09.html">
     Exercise IX: The Haxby Experiment (2001)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../resources/resources.html">
     Resources
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../zreferences.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/chapter_05/exercise_05.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/ZviBaratz/ml_for_neuro/issues/new?title=Issue%20on%20page%20%2Fchapters/chapter_05/exercise_05.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ZviBaratz/ml_for_neuro/master?urlpath=tree/source/chapters/chapter_05/exercise_05.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-up">
   Set up
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-inspection-and-preprocessing">
   General Inspection and Preprocessing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scaling">
     Scaling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pairwise-scatter-matrix">
     Pairwise Scatter-matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dummy-encoding">
     Dummy Encoding
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-creation">
   Model Creation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-application">
   Model Application
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-evaluation">
   Model Evaluation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alpha">
   Alpha
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coefficients">
     Coefficients
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-squared-error-mse">
     Mean Squared Error (MSE)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#r-2">
     <span class="math notranslate nohighlight">
      \(R^2\)
     </span>
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="exercise-v-regularization">
<h1>Exercise V: Regularization<a class="headerlink" href="#exercise-v-regularization" title="Permalink to this headline">¶</a></h1>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>More information about the dataset can be found <a class="reference external" href="https://rdrr.io/cran/ISLR/man/Hitters.html">here</a>.</p>
</div>
<p>This exercise is an adaptation of lab 2 from the <a class="reference external" href="http://faculty.marshall.usc.edu/gareth-james/ISL/ISLR%20Seventh%20Printing.pdf">ISLR</a>, in which the salary of baseball players is predicted on the basis of various statistics associated with performance in the previous year.</p>
<div class="section" id="set-up">
<h2>Set up<a class="headerlink" href="#set-up" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/JWarmenhoven/ISLR-python/master/Notebooks/Data/Hitters.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">URL</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="general-inspection-and-preprocessing">
<h2>General Inspection and Preprocessing<a class="headerlink" href="#general-inspection-and-preprocessing" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>League</th>
      <th>Division</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
      <th>Salary</th>
      <th>NewLeague</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-Andy Allanson</th>
      <td>293</td>
      <td>66</td>
      <td>1</td>
      <td>30</td>
      <td>29</td>
      <td>14</td>
      <td>1</td>
      <td>293</td>
      <td>66</td>
      <td>1</td>
      <td>30</td>
      <td>29</td>
      <td>14</td>
      <td>A</td>
      <td>E</td>
      <td>446</td>
      <td>33</td>
      <td>20</td>
      <td>NaN</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Alan Ashby</th>
      <td>315</td>
      <td>81</td>
      <td>7</td>
      <td>24</td>
      <td>38</td>
      <td>39</td>
      <td>14</td>
      <td>3449</td>
      <td>835</td>
      <td>69</td>
      <td>321</td>
      <td>414</td>
      <td>375</td>
      <td>N</td>
      <td>W</td>
      <td>632</td>
      <td>43</td>
      <td>10</td>
      <td>475.0</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Alvin Davis</th>
      <td>479</td>
      <td>130</td>
      <td>18</td>
      <td>66</td>
      <td>72</td>
      <td>76</td>
      <td>3</td>
      <td>1624</td>
      <td>457</td>
      <td>63</td>
      <td>224</td>
      <td>266</td>
      <td>263</td>
      <td>A</td>
      <td>W</td>
      <td>880</td>
      <td>82</td>
      <td>14</td>
      <td>480.0</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Andre Dawson</th>
      <td>496</td>
      <td>141</td>
      <td>20</td>
      <td>65</td>
      <td>78</td>
      <td>37</td>
      <td>11</td>
      <td>5628</td>
      <td>1575</td>
      <td>225</td>
      <td>828</td>
      <td>838</td>
      <td>354</td>
      <td>N</td>
      <td>E</td>
      <td>200</td>
      <td>11</td>
      <td>3</td>
      <td>500.0</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Andres Galarraga</th>
      <td>321</td>
      <td>87</td>
      <td>10</td>
      <td>39</td>
      <td>42</td>
      <td>30</td>
      <td>2</td>
      <td>396</td>
      <td>101</td>
      <td>12</td>
      <td>48</td>
      <td>46</td>
      <td>33</td>
      <td>N</td>
      <td>E</td>
      <td>805</td>
      <td>40</td>
      <td>4</td>
      <td>91.5</td>
      <td>N</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>-Willie McGee</th>
      <td>497</td>
      <td>127</td>
      <td>7</td>
      <td>65</td>
      <td>48</td>
      <td>37</td>
      <td>5</td>
      <td>2703</td>
      <td>806</td>
      <td>32</td>
      <td>379</td>
      <td>311</td>
      <td>138</td>
      <td>N</td>
      <td>E</td>
      <td>325</td>
      <td>9</td>
      <td>3</td>
      <td>700.0</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Willie Randolph</th>
      <td>492</td>
      <td>136</td>
      <td>5</td>
      <td>76</td>
      <td>50</td>
      <td>94</td>
      <td>12</td>
      <td>5511</td>
      <td>1511</td>
      <td>39</td>
      <td>897</td>
      <td>451</td>
      <td>875</td>
      <td>A</td>
      <td>E</td>
      <td>313</td>
      <td>381</td>
      <td>20</td>
      <td>875.0</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Wayne Tolleson</th>
      <td>475</td>
      <td>126</td>
      <td>3</td>
      <td>61</td>
      <td>43</td>
      <td>52</td>
      <td>6</td>
      <td>1700</td>
      <td>433</td>
      <td>7</td>
      <td>217</td>
      <td>93</td>
      <td>146</td>
      <td>A</td>
      <td>W</td>
      <td>37</td>
      <td>113</td>
      <td>7</td>
      <td>385.0</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Willie Upshaw</th>
      <td>573</td>
      <td>144</td>
      <td>9</td>
      <td>85</td>
      <td>60</td>
      <td>78</td>
      <td>8</td>
      <td>3198</td>
      <td>857</td>
      <td>97</td>
      <td>470</td>
      <td>420</td>
      <td>332</td>
      <td>A</td>
      <td>E</td>
      <td>1314</td>
      <td>131</td>
      <td>12</td>
      <td>960.0</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Willie Wilson</th>
      <td>631</td>
      <td>170</td>
      <td>9</td>
      <td>77</td>
      <td>44</td>
      <td>31</td>
      <td>11</td>
      <td>4908</td>
      <td>1457</td>
      <td>30</td>
      <td>775</td>
      <td>357</td>
      <td>249</td>
      <td>A</td>
      <td>W</td>
      <td>408</td>
      <td>4</td>
      <td>3</td>
      <td>1000.0</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
<p>322 rows × 20 columns</p>
</div></div></div>
</div>
<p>Well, it looks like a dataset.</p>
<p>Let’s probe a little deeper:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 322 entries, -Andy Allanson to -Willie Wilson
Data columns (total 20 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   AtBat      322 non-null    int64  
 1   Hits       322 non-null    int64  
 2   HmRun      322 non-null    int64  
 3   Runs       322 non-null    int64  
 4   RBI        322 non-null    int64  
 5   Walks      322 non-null    int64  
 6   Years      322 non-null    int64  
 7   CAtBat     322 non-null    int64  
 8   CHits      322 non-null    int64  
 9   CHmRun     322 non-null    int64  
 10  CRuns      322 non-null    int64  
 11  CRBI       322 non-null    int64  
 12  CWalks     322 non-null    int64  
 13  League     322 non-null    object 
 14  Division   322 non-null    object 
 15  PutOuts    322 non-null    int64  
 16  Assists    322 non-null    int64  
 17  Errors     322 non-null    int64  
 18  Salary     263 non-null    float64
 19  NewLeague  322 non-null    object 
dtypes: float64(1), int64(16), object(3)
memory usage: 52.8+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
</div>
</div>
<p>Calling <code class="docutils literal notranslate"><span class="pre">info()</span></code> reveals that most (<span class="pasted-text">16</span>/<span class="pasted-text">19</span>) columns contain integers, except for <code class="docutils literal notranslate"><span class="pre">Salary</span></code> which is a <code class="docutils literal notranslate"><span class="pre">float</span></code> and <code class="docutils literal notranslate"><span class="pre">League</span></code>, <code class="docutils literal notranslate"><span class="pre">NewLeague</span></code>, and <code class="docutils literal notranslate"><span class="pre">Division</span></code> which are <code class="docutils literal notranslate"><span class="pre">object</span></code> (categorical). Even more importantly, it shows that <code class="docutils literal notranslate"><span class="pre">Salary</span></code> contains missing observations. Because <code class="docutils literal notranslate"><span class="pre">Salary</span></code> is our target variable, we don’t really have any use for these observations and would be better off simply dropping them from our dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Salary&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Done.</p>
<p>Next, we might give <code class="docutils literal notranslate"><span class="pre">describe()</span></code> a quick look:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;float_format&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.4g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
      <th>Salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>403.6</td>
      <td>107.8</td>
      <td>11.62</td>
      <td>54.75</td>
      <td>51.49</td>
      <td>41.11</td>
      <td>7.312</td>
      <td>2658</td>
      <td>722.2</td>
      <td>69.24</td>
      <td>361.2</td>
      <td>330.4</td>
      <td>260.3</td>
      <td>290.7</td>
      <td>118.8</td>
      <td>8.593</td>
      <td>535.9</td>
    </tr>
    <tr>
      <th>std</th>
      <td>147.3</td>
      <td>45.13</td>
      <td>8.757</td>
      <td>25.54</td>
      <td>25.88</td>
      <td>21.72</td>
      <td>4.794</td>
      <td>2287</td>
      <td>648.2</td>
      <td>82.2</td>
      <td>331.2</td>
      <td>323.4</td>
      <td>264.1</td>
      <td>279.9</td>
      <td>145.1</td>
      <td>6.607</td>
      <td>451.1</td>
    </tr>
    <tr>
      <th>min</th>
      <td>19</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>19</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>67.5</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>282.5</td>
      <td>71.5</td>
      <td>5</td>
      <td>33.5</td>
      <td>30</td>
      <td>23</td>
      <td>4</td>
      <td>842.5</td>
      <td>212</td>
      <td>15</td>
      <td>105.5</td>
      <td>95</td>
      <td>71</td>
      <td>113.5</td>
      <td>8</td>
      <td>3</td>
      <td>190</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>413</td>
      <td>103</td>
      <td>9</td>
      <td>52</td>
      <td>47</td>
      <td>37</td>
      <td>6</td>
      <td>1931</td>
      <td>516</td>
      <td>40</td>
      <td>250</td>
      <td>230</td>
      <td>174</td>
      <td>224</td>
      <td>45</td>
      <td>7</td>
      <td>425</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>526</td>
      <td>141.5</td>
      <td>18</td>
      <td>73</td>
      <td>71</td>
      <td>57</td>
      <td>10</td>
      <td>3890</td>
      <td>1054</td>
      <td>92.5</td>
      <td>497.5</td>
      <td>424.5</td>
      <td>328.5</td>
      <td>322.5</td>
      <td>192</td>
      <td>13</td>
      <td>750</td>
    </tr>
    <tr>
      <th>max</th>
      <td>687</td>
      <td>238</td>
      <td>40</td>
      <td>130</td>
      <td>121</td>
      <td>105</td>
      <td>24</td>
      <td>1.405e+04</td>
      <td>4256</td>
      <td>548</td>
      <td>2165</td>
      <td>1659</td>
      <td>1566</td>
      <td>1377</td>
      <td>492</td>
      <td>32</td>
      <td>2460</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="scaling">
<h3>Scaling<a class="headerlink" href="#scaling" title="Permalink to this headline">¶</a></h3>
<p>I seems like there’s fairly large variabiliy in scale between the different features, and in any case regularization requires some form of standardization.</p>
<p>First, let’s differntiate the features matrix (<code class="docutils literal notranslate"><span class="pre">X</span></code>) from the target vector (<code class="docutils literal notranslate"><span class="pre">y</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target_name</span> <span class="o">=</span> <span class="s2">&quot;Salary&quot;</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">target_name</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Only numeric columns should be standardized, so let’s also be sure to distinguish those from the categoricals:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>And we’re all set:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">numeric_features</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span>
    <span class="n">X</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">numeric_features</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>League</th>
      <th>Division</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
      <th>NewLeague</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-Alan Ashby</th>
      <td>-0.6029</td>
      <td>-0.5957</td>
      <td>-0.5286</td>
      <td>-1.206</td>
      <td>-0.5221</td>
      <td>-0.09753</td>
      <td>1.398</td>
      <td>0.3468</td>
      <td>0.1744</td>
      <td>-0.00292</td>
      <td>-0.1217</td>
      <td>0.259</td>
      <td>0.4353</td>
      <td>N</td>
      <td>W</td>
      <td>1.221</td>
      <td>-0.5232</td>
      <td>0.2134</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Alvin Davis</th>
      <td>0.5125</td>
      <td>0.4923</td>
      <td>0.73</td>
      <td>0.4415</td>
      <td>0.7941</td>
      <td>1.609</td>
      <td>-0.9012</td>
      <td>-0.4529</td>
      <td>-0.4099</td>
      <td>-0.07605</td>
      <td>-0.4151</td>
      <td>-0.1996</td>
      <td>0.01037</td>
      <td>A</td>
      <td>W</td>
      <td>2.109</td>
      <td>-0.2539</td>
      <td>0.82</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Andre Dawson</th>
      <td>0.6282</td>
      <td>0.7365</td>
      <td>0.9588</td>
      <td>0.4023</td>
      <td>1.026</td>
      <td>-0.1898</td>
      <td>0.7709</td>
      <td>1.302</td>
      <td>1.318</td>
      <td>1.899</td>
      <td>1.412</td>
      <td>1.573</td>
      <td>0.3557</td>
      <td>N</td>
      <td>E</td>
      <td>-0.3247</td>
      <td>-0.7442</td>
      <td>-0.8482</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Andres Galarraga</th>
      <td>-0.5621</td>
      <td>-0.4625</td>
      <td>-0.1853</td>
      <td>-0.6177</td>
      <td>-0.3672</td>
      <td>-0.5127</td>
      <td>-1.11</td>
      <td>-0.9909</td>
      <td>-0.9602</td>
      <td>-0.6977</td>
      <td>-0.9475</td>
      <td>-0.8812</td>
      <td>-0.8623</td>
      <td>N</td>
      <td>E</td>
      <td>1.841</td>
      <td>-0.5439</td>
      <td>-0.6966</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Alfredo Griffin</th>
      <td>1.295</td>
      <td>1.358</td>
      <td>-0.8718</td>
      <td>0.7553</td>
      <td>-0.01884</td>
      <td>-0.2821</td>
      <td>0.7709</td>
      <td>0.767</td>
      <td>0.635</td>
      <td>-0.6124</td>
      <td>0.4228</td>
      <td>0.01729</td>
      <td>-0.2514</td>
      <td>A</td>
      <td>W</td>
      <td>-0.03118</td>
      <td>2.087</td>
      <td>2.488</td>
      <td>A</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>-Willie McGee</th>
      <td>0.635</td>
      <td>0.4257</td>
      <td>-0.5286</td>
      <td>0.4023</td>
      <td>-0.135</td>
      <td>-0.1898</td>
      <td>-0.4832</td>
      <td>0.01992</td>
      <td>0.1295</td>
      <td>-0.4539</td>
      <td>0.05378</td>
      <td>-0.06016</td>
      <td>-0.4639</td>
      <td>N</td>
      <td>E</td>
      <td>0.1227</td>
      <td>-0.758</td>
      <td>-0.8482</td>
      <td>N</td>
    </tr>
    <tr>
      <th>-Willie Randolph</th>
      <td>0.601</td>
      <td>0.6255</td>
      <td>-0.7574</td>
      <td>0.8338</td>
      <td>-0.05755</td>
      <td>2.44</td>
      <td>0.9799</td>
      <td>1.25</td>
      <td>1.219</td>
      <td>-0.3686</td>
      <td>1.621</td>
      <td>0.3736</td>
      <td>2.332</td>
      <td>A</td>
      <td>E</td>
      <td>0.07977</td>
      <td>1.811</td>
      <td>1.73</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Wayne Tolleson</th>
      <td>0.4853</td>
      <td>0.4034</td>
      <td>-0.9862</td>
      <td>0.2454</td>
      <td>-0.3285</td>
      <td>0.5022</td>
      <td>-0.2742</td>
      <td>-0.4196</td>
      <td>-0.447</td>
      <td>-0.7586</td>
      <td>-0.4363</td>
      <td>-0.7356</td>
      <td>-0.4336</td>
      <td>A</td>
      <td>W</td>
      <td>-0.9081</td>
      <td>-0.03978</td>
      <td>-0.2416</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Willie Upshaw</th>
      <td>1.152</td>
      <td>0.8031</td>
      <td>-0.2997</td>
      <td>1.187</td>
      <td>0.3295</td>
      <td>1.702</td>
      <td>0.1438</td>
      <td>0.2368</td>
      <td>0.2084</td>
      <td>0.3384</td>
      <td>0.3291</td>
      <td>0.2776</td>
      <td>0.2722</td>
      <td>A</td>
      <td>E</td>
      <td>3.662</td>
      <td>0.08452</td>
      <td>0.5167</td>
      <td>A</td>
    </tr>
    <tr>
      <th>-Willie Wilson</th>
      <td>1.546</td>
      <td>1.38</td>
      <td>-0.2997</td>
      <td>0.873</td>
      <td>-0.2898</td>
      <td>-0.4666</td>
      <td>0.7709</td>
      <td>0.9861</td>
      <td>1.136</td>
      <td>-0.4783</td>
      <td>1.252</td>
      <td>0.08236</td>
      <td>-0.04275</td>
      <td>A</td>
      <td>W</td>
      <td>0.4198</td>
      <td>-0.7925</td>
      <td>-0.8482</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
<p>263 rows × 19 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
      <td>263</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.013e-17</td>
      <td>5.741e-17</td>
      <td>3.377e-17</td>
      <td>-5.066e-17</td>
      <td>1.216e-16</td>
      <td>1.689e-18</td>
      <td>-5.403e-17</td>
      <td>6.079e-17</td>
      <td>6.754e-17</td>
      <td>5.403e-17</td>
      <td>3.377e-17</td>
      <td>4.053e-17</td>
      <td>1.081e-16</td>
      <td>7.43e-17</td>
      <td>0</td>
      <td>1.047e-16</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
      <td>1.002</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-2.616</td>
      <td>-2.372</td>
      <td>-1.329</td>
      <td>-2.148</td>
      <td>-1.993</td>
      <td>-1.897</td>
      <td>-1.319</td>
      <td>-1.156</td>
      <td>-1.11</td>
      <td>-0.844</td>
      <td>-1.087</td>
      <td>-1.014</td>
      <td>-0.9837</td>
      <td>-1.04</td>
      <td>-0.8201</td>
      <td>-1.303</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.8239</td>
      <td>-0.8066</td>
      <td>-0.7574</td>
      <td>-0.8334</td>
      <td>-0.8317</td>
      <td>-0.8356</td>
      <td>-0.6922</td>
      <td>-0.7953</td>
      <td>-0.7886</td>
      <td>-0.6611</td>
      <td>-0.7736</td>
      <td>-0.7294</td>
      <td>-0.7181</td>
      <td>-0.6343</td>
      <td>-0.7649</td>
      <td>-0.8482</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.06364</td>
      <td>-0.1072</td>
      <td>-0.2997</td>
      <td>-0.1077</td>
      <td>-0.1737</td>
      <td>-0.1898</td>
      <td>-0.2742</td>
      <td>-0.3183</td>
      <td>-0.3187</td>
      <td>-0.3564</td>
      <td>-0.3365</td>
      <td>-0.3111</td>
      <td>-0.3273</td>
      <td>-0.2388</td>
      <td>-0.5094</td>
      <td>-0.2416</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.8322</td>
      <td>0.7476</td>
      <td>0.73</td>
      <td>0.7161</td>
      <td>0.7554</td>
      <td>0.7329</td>
      <td>0.5619</td>
      <td>0.5402</td>
      <td>0.5129</td>
      <td>0.2835</td>
      <td>0.4123</td>
      <td>0.2915</td>
      <td>0.2589</td>
      <td>0.1138</td>
      <td>0.5058</td>
      <td>0.6683</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.927</td>
      <td>2.89</td>
      <td>3.247</td>
      <td>2.952</td>
      <td>2.691</td>
      <td>2.947</td>
      <td>3.488</td>
      <td>4.993</td>
      <td>5.462</td>
      <td>5.836</td>
      <td>5.457</td>
      <td>4.116</td>
      <td>4.954</td>
      <td>3.888</td>
      <td>2.578</td>
      <td>3.55</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="pairwise-scatter-matrix">
<h3>Pairwise Scatter-matrix<a class="headerlink" href="#pairwise-scatter-matrix" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/exercise_05_25_0.png" src="../../_images/exercise_05_25_0.png" />
</div>
</div>
</div>
<div class="section" id="dummy-encoding">
<h3>Dummy Encoding<a class="headerlink" href="#dummy-encoding" title="Permalink to this headline">¶</a></h3>
<p>To view the different values each categorical variable holds:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">X</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>League     [&#39;N&#39; &#39;A&#39;]
Division   [&#39;W&#39; &#39;E&#39;]
NewLeague  [&#39;N&#39; &#39;A&#39;]
</pre></div>
</div>
</div>
</div>
<p>And to “dummy encode” it is as simple as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;uint8&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_1d1c1_row0_col0, #T_1d1c1_row0_col2, #T_1d1c1_row1_col0, #T_1d1c1_row1_col2, #T_1d1c1_row2_col1, #T_1d1c1_row4_col1, #T_1d1c1_row5_col1, #T_1d1c1_row7_col0, #T_1d1c1_row7_col2, #T_1d1c1_row8_col0, #T_1d1c1_row8_col1, #T_1d1c1_row8_col2, #T_1d1c1_row10_col0, #T_1d1c1_row10_col1, #T_1d1c1_row10_col2, #T_1d1c1_row11_col1, #T_1d1c1_row12_col2, #T_1d1c1_row13_col0, #T_1d1c1_row13_col1, #T_1d1c1_row13_col2, #T_1d1c1_row14_col0, #T_1d1c1_row14_col1, #T_1d1c1_row14_col2, #T_1d1c1_row18_col1, #T_1d1c1_row19_col0, #T_1d1c1_row19_col2 {
  background-color: #fff7fb;
  color: #000000;
}
#T_1d1c1_row0_col1, #T_1d1c1_row1_col1, #T_1d1c1_row2_col0, #T_1d1c1_row2_col2, #T_1d1c1_row3_col0, #T_1d1c1_row3_col1, #T_1d1c1_row3_col2, #T_1d1c1_row4_col0, #T_1d1c1_row4_col2, #T_1d1c1_row5_col0, #T_1d1c1_row5_col2, #T_1d1c1_row6_col0, #T_1d1c1_row6_col1, #T_1d1c1_row6_col2, #T_1d1c1_row7_col1, #T_1d1c1_row9_col0, #T_1d1c1_row9_col1, #T_1d1c1_row9_col2, #T_1d1c1_row11_col0, #T_1d1c1_row11_col2, #T_1d1c1_row12_col0, #T_1d1c1_row12_col1, #T_1d1c1_row15_col0, #T_1d1c1_row15_col1, #T_1d1c1_row15_col2, #T_1d1c1_row16_col0, #T_1d1c1_row16_col1, #T_1d1c1_row16_col2, #T_1d1c1_row17_col0, #T_1d1c1_row17_col1, #T_1d1c1_row17_col2, #T_1d1c1_row18_col0, #T_1d1c1_row18_col2, #T_1d1c1_row19_col1 {
  background-color: #023858;
  color: #f1f1f1;
}
</style>
<table id="T_1d1c1_">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th class="col_heading level0 col0" >League_N</th>
      <th class="col_heading level0 col1" >Division_W</th>
      <th class="col_heading level0 col2" >NewLeague_N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_1d1c1_level0_row0" class="row_heading level0 row0" >-Roy Smalley</th>
      <td id="T_1d1c1_row0_col0" class="data row0 col0" >0</td>
      <td id="T_1d1c1_row0_col1" class="data row0 col1" >1</td>
      <td id="T_1d1c1_row0_col2" class="data row0 col2" >0</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row1" class="row_heading level0 row1" >-Tim Laudner</th>
      <td id="T_1d1c1_row1_col0" class="data row1 col0" >0</td>
      <td id="T_1d1c1_row1_col1" class="data row1 col1" >1</td>
      <td id="T_1d1c1_row1_col2" class="data row1 col2" >0</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row2" class="row_heading level0 row2" >-Wally Backman</th>
      <td id="T_1d1c1_row2_col0" class="data row2 col0" >1</td>
      <td id="T_1d1c1_row2_col1" class="data row2 col1" >0</td>
      <td id="T_1d1c1_row2_col2" class="data row2 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row3" class="row_heading level0 row3" >-Alan Ashby</th>
      <td id="T_1d1c1_row3_col0" class="data row3 col0" >1</td>
      <td id="T_1d1c1_row3_col1" class="data row3 col1" >1</td>
      <td id="T_1d1c1_row3_col2" class="data row3 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row4" class="row_heading level0 row4" >-Andy VanSlyke</th>
      <td id="T_1d1c1_row4_col0" class="data row4 col0" >1</td>
      <td id="T_1d1c1_row4_col1" class="data row4 col1" >0</td>
      <td id="T_1d1c1_row4_col2" class="data row4 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row5" class="row_heading level0 row5" >-Jim Morrison</th>
      <td id="T_1d1c1_row5_col0" class="data row5 col0" >1</td>
      <td id="T_1d1c1_row5_col1" class="data row5 col1" >0</td>
      <td id="T_1d1c1_row5_col2" class="data row5 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row6" class="row_heading level0 row6" >-Harry Spilman</th>
      <td id="T_1d1c1_row6_col0" class="data row6 col0" >1</td>
      <td id="T_1d1c1_row6_col1" class="data row6 col1" >1</td>
      <td id="T_1d1c1_row6_col2" class="data row6 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row7" class="row_heading level0 row7" >-Gary Ward</th>
      <td id="T_1d1c1_row7_col0" class="data row7 col0" >0</td>
      <td id="T_1d1c1_row7_col1" class="data row7 col1" >1</td>
      <td id="T_1d1c1_row7_col2" class="data row7 col2" >0</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row8" class="row_heading level0 row8" >-Johnny Grubb</th>
      <td id="T_1d1c1_row8_col0" class="data row8 col0" >0</td>
      <td id="T_1d1c1_row8_col1" class="data row8 col1" >0</td>
      <td id="T_1d1c1_row8_col2" class="data row8 col2" >0</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row9" class="row_heading level0 row9" >-Kevin McReynolds</th>
      <td id="T_1d1c1_row9_col0" class="data row9 col0" >1</td>
      <td id="T_1d1c1_row9_col1" class="data row9 col1" >1</td>
      <td id="T_1d1c1_row9_col2" class="data row9 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row10" class="row_heading level0 row10" >-Alan Trammell</th>
      <td id="T_1d1c1_row10_col0" class="data row10 col0" >0</td>
      <td id="T_1d1c1_row10_col1" class="data row10 col1" >0</td>
      <td id="T_1d1c1_row10_col2" class="data row10 col2" >0</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row11" class="row_heading level0 row11" >-Tim Wallach</th>
      <td id="T_1d1c1_row11_col0" class="data row11 col0" >1</td>
      <td id="T_1d1c1_row11_col1" class="data row11 col1" >0</td>
      <td id="T_1d1c1_row11_col2" class="data row11 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row12" class="row_heading level0 row12" >-Terry Harper</th>
      <td id="T_1d1c1_row12_col0" class="data row12 col0" >1</td>
      <td id="T_1d1c1_row12_col1" class="data row12 col1" >1</td>
      <td id="T_1d1c1_row12_col2" class="data row12 col2" >0</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row13" class="row_heading level0 row13" >-Jim Rice</th>
      <td id="T_1d1c1_row13_col0" class="data row13 col0" >0</td>
      <td id="T_1d1c1_row13_col1" class="data row13 col1" >0</td>
      <td id="T_1d1c1_row13_col2" class="data row13 col2" >0</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row14" class="row_heading level0 row14" >-Larry Herndon</th>
      <td id="T_1d1c1_row14_col0" class="data row14 col0" >0</td>
      <td id="T_1d1c1_row14_col1" class="data row14 col1" >0</td>
      <td id="T_1d1c1_row14_col2" class="data row14 col2" >0</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row15" class="row_heading level0 row15" >-Tim Flannery</th>
      <td id="T_1d1c1_row15_col0" class="data row15 col0" >1</td>
      <td id="T_1d1c1_row15_col1" class="data row15 col1" >1</td>
      <td id="T_1d1c1_row15_col2" class="data row15 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row16" class="row_heading level0 row16" >-Dale Murphy</th>
      <td id="T_1d1c1_row16_col0" class="data row16 col0" >1</td>
      <td id="T_1d1c1_row16_col1" class="data row16 col1" >1</td>
      <td id="T_1d1c1_row16_col2" class="data row16 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row17" class="row_heading level0 row17" >-Jose Cruz</th>
      <td id="T_1d1c1_row17_col0" class="data row17 col0" >1</td>
      <td id="T_1d1c1_row17_col1" class="data row17 col1" >1</td>
      <td id="T_1d1c1_row17_col2" class="data row17 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row18" class="row_heading level0 row18" >-Rick Schu</th>
      <td id="T_1d1c1_row18_col0" class="data row18 col0" >1</td>
      <td id="T_1d1c1_row18_col1" class="data row18 col1" >0</td>
      <td id="T_1d1c1_row18_col2" class="data row18 col2" >1</td>
    </tr>
    <tr>
      <th id="T_1d1c1_level0_row19" class="row_heading level0 row19" >-Oddibe McDowell</th>
      <td id="T_1d1c1_row19_col0" class="data row19 col0" >0</td>
      <td id="T_1d1c1_row19_col1" class="data row19 col1" >1</td>
      <td id="T_1d1c1_row19_col2" class="data row19 col2" >0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
</div>
<div class="section" id="model-creation">
<h2>Model Creation<a class="headerlink" href="#model-creation" title="Permalink to this headline">¶</a></h2>
<p>In the previous linear regression exercise we used <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html"><code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code></a> class along with the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html"><code class="docutils literal notranslate"><span class="pre">train_test_split()</span></code></a> function to model the relationship between the features and the target variable and evaluate it’s performance in predicting the target variable for an out-of-sample collection of observations. In this exercise, we will use <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LassoCV.html#sklearn.linear_model.LassoCV"><code class="docutils literal notranslate"><span class="pre">LassoCV</span></code></a> and <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RidgeCV.html"><code class="docutils literal notranslate"><span class="pre">RidgeCV</span></code></a> to introduce the <span class="math notranslate nohighlight">\(\ell_1\)</span> and <span class="math notranslate nohighlight">\(\ell_2\)</span> penalties as part of our fitting process and regularize the coefficients of our predictors. In addition, <a class="reference external" href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)">cross-validation</a> will also be taken care of automatically.</p>
<p>For the sake of uniformity we’ll use the same list of regularization parameter values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Lasso (<span class="math notranslate nohighlight">\(\ell_1\)</span>)</p>
</div>
<div class="card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LassoCV</span>

<span class="n">lasso_model</span> <span class="o">=</span> <span class="n">LassoCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Ridge (<span class="math notranslate nohighlight">\(\ell_2\)</span>)</p>
</div>
<div class="card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">RidgeCV</span>

<span class="n">ridge_model</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span> <span class="n">store_cv_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">LassoCV</span></code> will use 5-fold cross-validation with <span class="math notranslate nohighlight">\(R^2\)</span> as the scoring method and <code class="docutils literal notranslate"><span class="pre">RidgeCV</span></code> will use Generalized Cross-Validation, which is a form of efficient Leave-One-Out cross-validation, with negative mean squared error.</p>
<p>To change the splitting strategy, set the <code class="docutils literal notranslate"><span class="pre">cv</span></code> keyword argument to the number of folds you’d like to use, to specify scoring and other search parameters see the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV"><code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code></a> class.</p>
</div>
</div>
<div class="section" id="model-application">
<h2>Model Application<a class="headerlink" href="#model-application" title="Permalink to this headline">¶</a></h2>
<p>To calculate the predicted salary of each player using the model:</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Lasso (<span class="math notranslate nohighlight">\(\ell_1\)</span>)</p>
</div>
<div class="card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lasso_predictions</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Ridge (<span class="math notranslate nohighlight">\(\ell_2\)</span>)</p>
</div>
<div class="card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ridge_predictions</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
</div>
<div class="section" id="model-evaluation">
<h2>Model Evaluation<a class="headerlink" href="#model-evaluation" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="k">def</span> <span class="nf">plot_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">predictions</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Real Values&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Predicted Values&quot;</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plot_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">lasso_predictions</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Lasso ($\ell_1$)&quot;</span><span class="p">)</span>
<span class="n">plot_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ridge_predictions</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Lasso ($\ell_2$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/exercise_05_45_0.png" src="../../_images/exercise_05_45_0.png" />
</div>
</div>
</div>
<div class="section" id="alpha">
<h2>Alpha<a class="headerlink" href="#alpha" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Lasso (<span class="math notranslate nohighlight">\(\ell_1\)</span>)</p>
</div>
<div class="card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lasso_model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
<p class="card-text"><span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">2.522311557788944</span></code></span></p>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Ridge (<span class="math notranslate nohighlight">\(\ell_2\)</span>)</p>
</div>
<div class="card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ridge_model</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
<p class="card-text"><span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">3.527236180904522</span></code></span></p>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="coefficients">
<h3>Coefficients<a class="headerlink" href="#coefficients" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coefficients_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Lasso&quot;</span><span class="p">:</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="s2">&quot;Ridge&quot;</span><span class="p">:</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">}</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">coefficients_dict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">coefficients</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AtBat</th>
      <th>Hits</th>
      <th>HmRun</th>
      <th>Runs</th>
      <th>RBI</th>
      <th>Walks</th>
      <th>Years</th>
      <th>CAtBat</th>
      <th>CHits</th>
      <th>CHmRun</th>
      <th>CRuns</th>
      <th>CRBI</th>
      <th>CWalks</th>
      <th>PutOuts</th>
      <th>Assists</th>
      <th>Errors</th>
      <th>League_N</th>
      <th>Division_W</th>
      <th>NewLeague_N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lasso</th>
      <td>-237.2</td>
      <td>261.6</td>
      <td>0</td>
      <td>-0</td>
      <td>0</td>
      <td>104.8</td>
      <td>-46.64</td>
      <td>-0</td>
      <td>0</td>
      <td>44.29</td>
      <td>224.5</td>
      <td>123.9</td>
      <td>-144.8</td>
      <td>76.81</td>
      <td>26.48</td>
      <td>-13.56</td>
      <td>27.04</td>
      <td>-114.1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Ridge</th>
      <td>-216.4</td>
      <td>230.7</td>
      <td>0.9447</td>
      <td>0.7865</td>
      <td>6.002</td>
      <td>106.3</td>
      <td>-51.34</td>
      <td>-94.18</td>
      <td>119.4</td>
      <td>58.18</td>
      <td>199.9</td>
      <td>114.5</td>
      <td>-144.5</td>
      <td>77.68</td>
      <td>39.18</td>
      <td>-24.86</td>
      <td>50.73</td>
      <td>-118.6</td>
      <td>-18.02</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span>


<span class="n">coef_fig</span><span class="p">,</span> <span class="n">coef_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1">#########</span>
<span class="c1"># Lasso #</span>
<span class="c1">#########</span>

<span class="n">simple_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span>
<span class="n">lasso_coefficient_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lasso_alphas</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">alphas_</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">lasso_alphas</span><span class="p">:</span>
    <span class="n">simple_lasso</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">simple_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">lasso_coefficient_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simple_lasso</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="c1"># Coefficient values by alpha</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">lasso_alphas</span><span class="p">,</span> <span class="n">lasso_coefficient_values</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Chosen alpha</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lasso_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span>
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Chosen $\alpha$&quot;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Coefficient Values&quot;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Lasso: Coefficient Values by $\alpha$&quot;</span><span class="p">)</span>

<span class="c1">#########</span>
<span class="c1"># Ridge #</span>
<span class="c1">#########</span>

<span class="n">simple_ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<span class="n">ridge_coefficient_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ridge_alphas</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">alphas</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">ridge_alphas</span><span class="p">:</span>
    <span class="n">simple_ridge</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">simple_ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ridge_coefficient_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simple_ridge</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>


<span class="c1"># Coefficient values by alpha</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ridge_alphas</span><span class="p">,</span>
                   <span class="n">ridge_coefficient_values</span><span class="p">,</span>
                   <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Chosen alpha</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ridge_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span>
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Chosen $\alpha$&quot;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">))</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>
<span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Coefficient Values&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">coef_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Ridge: Coefficient Values by $\alpha$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/exercise_05_52_0.png" src="../../_images/exercise_05_52_0.png" />
</div>
</div>
</div>
<div class="section" id="mean-squared-error-mse">
<h3>Mean Squared Error (MSE)<a class="headerlink" href="#mean-squared-error-mse" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mse_fig</span><span class="p">,</span> <span class="n">mse_ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1">#########</span>
<span class="c1"># Lasso #</span>
<span class="c1">#########</span>

<span class="n">lasso_alphas</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">alphas_</span>
<span class="n">lasso_mse</span> <span class="o">=</span> <span class="n">lasso_model</span><span class="o">.</span><span class="n">mse_path_</span>

<span class="c1"># Cross-validation MSEs</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">lasso_alphas</span><span class="p">,</span>
                   <span class="n">lasso_mse</span><span class="p">,</span>
                   <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                   <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Mean MSE</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lasso_alphas</span><span class="p">,</span>
               <span class="n">lasso_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
               <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mean MSE Across Folds&quot;</span><span class="p">,</span>
               <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Chosen alpha</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lasso_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span>
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Chosen $\alpha$&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;MSE&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Lasso: Mean Squared Error (MSE) Across Folds&quot;</span><span class="p">)</span>

<span class="c1">#########</span>
<span class="c1"># Ridge #</span>
<span class="c1">#########</span>

<span class="n">ridge_alphas</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">alphas</span>
<span class="n">ridge_mse</span> <span class="o">=</span> <span class="n">ridge_model</span><span class="o">.</span><span class="n">cv_values_</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># Cross-validation MSEs</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ridge_alphas</span><span class="p">,</span>
                   <span class="n">ridge_mse</span><span class="p">,</span>
                   <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span>
                   <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
                   <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="c1"># Mean MSE</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ridge_alphas</span><span class="p">,</span>
               <span class="n">ridge_mse</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
               <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mean MSE Across Folds&quot;</span><span class="p">,</span>
               <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Chosen alpha</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">ridge_model</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span>
                  <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Chosen $\alpha$&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\alpha$&#39;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;MSE&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">mse_ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">mse_ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ridge: Mean Squared Error (MSE) Across Folds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/exercise_05_54_0.png" src="../../_images/exercise_05_54_0.png" />
</div>
</div>
</div>
<div class="section" id="r-2">
<h3><span class="math notranslate nohighlight">\(R^2\)</span><a class="headerlink" href="#r-2" title="Permalink to this headline">¶</a></h3>
<p>To calculate in-sample <span class="math notranslate nohighlight">\(R^2\)</span> score for each model:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
</div>
</div>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Lasso (<span class="math notranslate nohighlight">\(\ell_1\)</span>)</p>
</div>
<div class="card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lasso_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="card-text"><span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">0.5342574616741456</span></code></span></p>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Ridge (<span class="math notranslate nohighlight">\(\ell_2\)</span>)</p>
</div>
<div class="card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ridge_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p class="card-text"><span class="pasted-inline"><code class="output text_plain docutils literal notranslate"><span class="pre">0.5364706351171289</span></code></span></p>
</div>
</div>
</div>
</div>
</div>
<p>Note that calculating in-sample <span class="math notranslate nohighlight">\(R^2\)</span> scores will result in underestimating prediction error.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a more generalized solution for parameter tuning, see <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>’s <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV"><code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code></a>.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/chapter_05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../chapter_04/exercise_04.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Exercise IV: Logistic Regression</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../chapter_06/exercise_06.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercise VI: Revisiting Linear and Logistic Regression</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Dr. Shlomi Lifshits, Zvi Baratz<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>